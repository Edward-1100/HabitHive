<!doctype html>

<html lang="en">

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <title>Leaderboard</title>

    <link rel="stylesheet" href="/css/style.css" />
  </head>

  <body>
    <%- include('partials/nav') %>

    <main class="container">
      <h1><%= title || 'Leaderboard' %></h1>

      <table class="leaderboard-table" role="table" aria-label="Leaderboard">

        <thead>

          <tr>
            <th class="leaderboard-rank">Rank</th>
            <th>User</th>
            <th>Points</th>
          </tr>

        </thead>

        <tbody>

          <% if (!topUsers || topUsers.length === 0) { %>
            <tr><td colspan="3">No users yet.</td></tr>
          <% } else { %>

            <% topUsers.forEach((u, i) => { %>
              
              <tr class="<%= (highlightId && String(u._id) === highlightId) ? 'leaderboard-highlight' : '' %>">
                <td class="leaderboard-rank"><%= i + 1 %></td>
                <td><a href="/profile/<%= u._id %>"><%= u.username %></a></td>
                <td><%= u.points || 0 %></td>
              </tr>

            <% }) %>

          <% } %>

          <% if (currentUser && !inTop) { %>
            <tr class="spacer-row"><td colspan="3"></td></tr>
            
            <tr class="leaderboard-highlight">
              <td class="leaderboard-rank"><%= userRank %></td>
              <td><a href="/profile/<%= currentUser._id %>"><%= currentUser.username %></a></td>
              <td><%= currentUser.points || 0 %></td>
            </tr>

          <% } %>

        </tbody>

      </table>

    </main>

  </body>

</html>
